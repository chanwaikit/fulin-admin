(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{365:function(e,t,a){"use strict";function n(){}var r=a(376),i=a.n(r),o=(r=a(81),a.n(r)),s=(r=a(377),a.n(r)),l=(r=a(378),a.n(r)),c="".concat(window.location.origin,"/api");function u(e,t,a){return e?a?"".concat(e,".").concat(t):e+t:t}t.a=function(e){var t,a=void 0!==(t=e.custom)&&t,r=void 0===(t=e.api)?"":t,d=void 0===(t=e.type)?"POST":t,m=void 0===(t=e.data)?{}:t,v=void 0===(t=e.success)?n:t,p=void 0===(e=e.error)?n:e;return new Promise((function(e,t){var n;l()(d,a?"".concat(r):c+r).timeout(2e5).type("form").withCredentials().send((function e(t,a,n){if(a)if(o()(a))for(var r=0;r<a.length;r++){var l=a[r];e(u(t,"[".concat(r,"]"),!1),l,n)}else s()(a)?"map"===a.__type__?i()(a,(function(a,r){"__type__"!==r&&e(u(t,"[".concat(r,"]"),!1),a,n)})):i()(a,(function(a,r){e(u(t,r,!0),a,n)})):n[t]=a}(null,m,n={}),n)).end((function(e,a){e||!a.ok?(console.log("not 200 error msg:".concat(e)),p(e),t(e)):(a=a.text.replace(/([^\\])":(\d{15,})/g,'$1":"$2"'),a=JSON.parse(a),v(a.response))}))}))}},379:function(e,t){},581:function(e,t,a){},640:function(e,t,a){"use strict";a.r(t);var n=a(407),r=a.n(n),i=a(380),o=a.n(i),s=a(425),l=a.n(s),c=a(367),u=a.n(c),d=a(391),m=a.n(d),v=(n=a(372),a.n(n)),p=(i=a(373),a.n(i)),b=a(385),f=a(58),g=a(59),h=a(61),y=a(60),k=(s=a(369),c=a.n(s),d=a(366),a.n(d)),N=(n=a(592),i=a.n(n),s=a(582),d=a.n(s),n=a(0),a.n(n)),D=a(365),E=(s=a(368),a.n(s)),w=(s=a(359),a.n(s)),S=a(360),_=(a(581),d.a.TextArea,i.a.Dragger,k.a.Option),C=c.a.RangePicker;n=function(e){Object(h.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={modalSpinning:!1,spinning:!1,visible:!1,selectedRowKeys:[],selectedRows:[],cid:"",mid:"",tableData:[],modalSelect:"total_volume",pickerDate:[w()("2021-07-01","YYYY-MM-DD"),w()("2021/07/28","YYYY-MM-DD")]},e.test=function(){var t=(n=e.state).cid,a=n.mid,n=void 0===(n=n.pickerDate)?[]:n;Object(D.a)({type:"POST",api:"/create-entry",data:{startDate:E()(n[0]).format("YYYY-MM-DD"),endDate:E()(n[1]).format("YYYY-MM-DD"),cid:t,mid:a},success:function(){},error:function(){}})},e.getModalData=function(){var t=void 0===(t=((t=e.state).cid,t.mid,t.pickerDate))?[]:t;e.setState({modalSpinning:!0}),Object(D.a)({type:"POST",api:"/statistic/getSkuWeekStatistic",data:{startDate:E()(t[0]).format("YYYY-MM-DD"),endDate:E()(t[1]).format("YYYY-MM-DD")},success:function(){var t=void 0===(n=(a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).daysArray)?[]:n,a=void 0===(n=a.skuWeekData)?[]:n,n=t.map((function(e){return e.start_date_str}));(a=Object(b.a)(a)).map((function(e){return e.map((function(e,t){var a=Number(e.spOrderNum||0)+Number(e.sbSkuOrderNum||0)+Number(e.sbvOrderNum||0)+Number(e.sdOrderNum||0),n=(Number(e.spCost||0)+Number(e.sbSkuCost||0)+Number(e.sbvCost||0)+Number(e.sdCost||0)).toFixed(2);return e.key=e.local_sku+"_"+e.mid,e.allOrders=Number(a),e.adCost=Number(n),e.adCpo=a?(n/a).toFixed(2):0,e}))})),e.setState({modalSpinning:!1,daysArray:t,legendData:n,skuWeekData:a},(function(){e.initChartPie()}))},error:function(){}})},e.initChartPie=function(){var t=(s=e.state).categories,a=s.modalSelect,n=void 0===(t=s.selectedRowKeys)?[]:t,r=void 0===(t=s.tableData)?[]:t,i=void 0===(t=s.legendData)?[]:t,o=void 0===(t=s.skuWeekData)?[]:t,s=(t=s.x_axis,document.getElementById("chart_pie")),l=(t=S.init(s,"dark"),[]),c=[];i.map((function(e,t){var i=[],s=[];n.map((function(e){var n=o[t].filter((function(t){return t.local_sku_mid===e}))[0]||{};i.push(Number(n[a]||0)),n=r.filter((function(t){return t.local_sku_mid===e}))[0]||{},s.push(n.local_sku+"_"+n.country)})),l.push(i),c.push(s)}));var u=[];l.map((function(e,t){u.push({name:i[t],type:"bar",barGap:0,emphasis:{focus:"series"},data:e})})),s={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:i},dataZoom:[{show:!0,realtime:!0,start:0,end:100,xAxisIndex:[0,1]}],toolbox:{show:!0,orient:"vertical",left:"right",top:"center",feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},xAxis:[{type:"category",axisTick:{show:!1},data:c[0]}],yAxis:[{type:"value"}],series:u},t.setOption(s)},e.getData=function(){var t=(n=e.state).cid,a=n.mid,n=void 0===(n=n.pickerDate)?[]:n;e.setState({spinning:!0}),Object(D.a)({type:"POST",api:"/statistic/getProfit",data:{startDate:E()(n[0]).format("YYYY-MM-DD"),endDate:E()(n[1]).format("YYYY-MM-DD"),cid:t,mid:a},success:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};t.map((function(e,t){var a=Number(e.spOrderNum||0)+Number(e.sbSkuOrderNum||0)+Number(e.sbvOrderNum||0)+Number(e.sdOrderNum||0),n=(Number(e.spCost||0)+Number(e.sbSkuCost||0)+Number(e.sbvCost||0)+Number(e.sdCost||0)).toFixed(2);return e.key=e.local_sku+"_"+e.mid,e.allOrders=a,e.adCost=n,e.adCpo=a?(n/a).toFixed(2):0,e})),e.setState({spinning:!1,tableData:t||[]},(function(){console.log(t)}))},error:function(){}})},e.getColumns=function(){return[{title:"\u56fe\u7247",dataIndex:"small_image_url",key:"small_image_url",render:function(e,t){return N.a.createElement("img",{style:{width:36,height:36},src:e})}},{title:"\u54c1\u540d",dataIndex:"local_name",key:"local_name",render:function(e,t){return N.a.createElement("div",null,N.a.createElement("div",null,t.local_name))}},{title:"\u56fd\u5bb6",dataIndex:"country",key:"country"},{title:"\u9500\u91cf",dataIndex:"total_volume",key:"total_volume"},{title:"\u9500\u552e\u989d",dataIndex:"total_amount",key:"total_amount",render:function(e,t){return N.a.createElement("span",null,e&&Number(e).toFixed(2))}},{title:"\u5e7f\u544a\u82b1\u8d39",dataIndex:"address",key:"address",render:function(e,t){return N.a.createElement("div",null,(Number(t.spCost||0)+Number(t.sbSkuCost||0)+Number(t.sbvCost||0)+Number(t.sdCost||0)).toFixed(2))}},{title:"\u5e7f\u544a\u8ba2\u5355\u91cf",dataIndex:"address",key:"address",render:function(e,t){return N.a.createElement("div",null,Number(t.spOrderNum||0)+Number(t.sbSkuOrderNum||0)+Number(t.sbvOrderNum||0)+Number(t.sdOrderNum||0))}},{title:"\u6bcf\u5355\u82b1\u8d39",dataIndex:"sessions",key:"sessions",render:function(e,t){var a=Number(t.spOrderNum||0)+Number(t.sbSkuOrderNum||0)+Number(t.sbvOrderNum||0)+Number(t.sdOrderNum||0);t=(Number(t.spCost||0)+Number(t.sbSkuCost||0)+Number(t.sbvCost||0)+Number(t.sdCost||0)).toFixed(2);return N.a.createElement("div",null,a?(t/a).toFixed(2):0)}}]},e.onSelectChange=function(t,a){e.setState({selectedRowKeys:t,selectedRows:a})},e.handleClose=function(t){var a=(r=e.state).selectedRowKeys,n=r.selectedRows,r=Object(b.a)(a);n=Object(b.a)(n);r.splice(a.indexOf(t),1),n.splice(a.indexOf(t),1),e.setState({selectedRowKeys:r,selectedRows:n})},e.showModal=function(){e.setState({visible:!0},(function(){e.getModalData()}))},e}return Object(g.a)(a,[{key:"componentDidMount",value:function(){this.getData(),this.test()}},{key:"render",value:function(){var e=this,t=(g=this.state).spinning,a=g.modalSelect,n=g.modalSpinning,i=g.visible,s=g.mid,c=void 0===(f=g.selectedRows)?[]:f,d=g.selectedRowKeys,b=g.cid,f=void 0===(f=g.tableData)?[]:f,g=void 0===(g=g.pickerDate)?[]:g;d={selectedRowKeys:void 0===d?[]:d,onChange:this.onSelectChange};return N.a.createElement("div",{className:"week-report"},N.a.createElement("div",{style:{marginBottom:"16px"}},N.a.createElement(v.a,null,N.a.createElement(p.a,{span:6},"\u8bf7\u9009\u62e9\u5206\u7c7b\uff1a",N.a.createElement(k.a,{value:String(b),style:{width:120},onChange:function(t){e.setState({cid:t},(function(){e.getData()}))}},N.a.createElement(_,{value:""},"\u5168\u90e8"),N.a.createElement(_,{value:"1001"},"\u7f8e\u5986"),N.a.createElement(_,{value:"1002"},"\u7535\u5b50\u5668\u4ef6"))),N.a.createElement(p.a,{span:6},"\u8bf7\u9009\u62e9\u56fd\u5bb6\uff1a",N.a.createElement(k.a,{value:String(s),style:{width:120},onChange:function(t){e.setState({mid:t},(function(){e.getData()}))}},N.a.createElement(_,{value:""},"\u5168\u90e8"),N.a.createElement(_,{value:"1"},"\u7f8e\u56fd"),N.a.createElement(_,{value:"4"},"\u82f1\u56fd"),N.a.createElement(_,{value:"5"},"\u5fb7\u56fd"),N.a.createElement(_,{value:"6"},"\u6cd5\u56fd"),N.a.createElement(_,{value:"7"},"\u610f\u5927\u5229"),N.a.createElement(_,{value:"8"},"\u897f\u73ed\u7259"),N.a.createElement(_,{value:"10"},"\u65e5\u672c"),N.a.createElement(_,{value:"15"},"\u8377\u5170"))),N.a.createElement(p.a,{span:6},"\u8bf7\u9009\u62e9\u65f6\u95f4\uff1a",N.a.createElement(C,{value:g,onChange:function(t){e.setState({pickerDate:t},(function(){e.getData()}))}})))),0<c.length&&N.a.createElement("div",{className:"selected-bar"},"\u5df2\u9009\u4e2d: ",c.map((function(t){return N.a.createElement(m.a,{closable:!0,key:t.local_sku+"_"+t.mid,onClose:function(){return e.handleClose(t.local_sku+"_"+t.mid)}},t.local_sku+"_"+t.country)})),N.a.createElement(u.a,{type:"primary",onClick:function(){e.showModal()}},"\u67e5\u770b\u8be6\u60c5")),N.a.createElement(o.a,{size:"large",tip:"\u6b63\u5728\u83b7\u53d6\u6570\u636e\uff0c\u8bf7\u7a0d\u7b49...",spinning:t},N.a.createElement(l.a,{sticky:!0,rowSelection:d,size:"small",pagination:!1,dataSource:f,columns:this.getColumns()})),N.a.createElement(r.a,{title:"\u8be6\u60c5\u5bf9\u7167",centered:!0,visible:i,onOk:function(){return e.setState({visible:!1})},onCancel:function(){return e.setState({visible:!1})},width:"100vw",bodyStyle:{height:"80vh"}},N.a.createElement(o.a,{spinning:n,style:{width:"100%",height:"70vh"}},N.a.createElement("div",{style:{marginBottom:"16px"}},N.a.createElement(v.a,null,N.a.createElement(p.a,{span:6},"\u8bf7\u9009\u62e9\u7c7b\u522b\uff1a",N.a.createElement(k.a,{value:String(a),style:{width:120},onChange:function(t){e.setState({modalSelect:t},(function(){e.initChartPie()}))}},N.a.createElement(_,{value:"total_volume"},"\u9500\u91cf"),N.a.createElement(_,{value:"total_amount"},"\u9500\u552e\u989d"),N.a.createElement(_,{value:"adCost"},"\u5e7f\u544a\u82b1\u8d39"),N.a.createElement(_,{value:"allOrders"},"\u5e7f\u544a\u8ba2\u5355\u91cf"),N.a.createElement(_,{value:"adCpo"},"\u6bcf\u5355\u82b1\u8d39"))))),N.a.createElement("div",{id:"chart_pie",style:{width:"100%",height:"70vh"}}))))}}]),a}(n.PureComponent||n.Component);t.default=n}}]);
//# sourceMappingURL=8.e69570bf.chunk.js.map