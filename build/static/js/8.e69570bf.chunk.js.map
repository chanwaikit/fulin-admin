{"version":3,"sources":["utils/callApi.js","routes/category-list/index.js"],"names":["noop","apiBase","window","location","origin","prepend","prefix","name","separator","callApi","custom","api","type","data","success","error","Promise","resolve","reject","map","request","timeout","withCredentials","send","flatten","obj","isArray","i","length","item","isPlainObject","__type__","each","propertyObject","propertyName","end","err","res","ok","console","log","stringifiedBigNumber","text","replace","body","JSON","parse","response","Option","TextArea","Dragger","RangePicker","Logon","state","modalSpinning","spinning","visible","selectedRowKeys","selectedRows","cid","mid","tableData","modalSelect","pickerDate","moment","test","startDate","dayjs","format","endDate","getModalData","setState","daysArray","skuWeekData","legendData","start_date_str","pSkuWeekData","arr","index","orders","Number","spOrderNum","sbSkuOrderNum","sbvOrderNum","sdOrderNum","adCost","spCost","sbSkuCost","sbvCost","sdCost","toFixed","key","local_sku","allOrders","adCpo","initChartPie","categories","chartDom","x_axis","document","getElementById","totalVolumeArray","myChart","echarts","nameArray","dayStr","childArray","nameChiladArray","keyValue","filter","element","local_sku_mid","push","tableObj","country","series","barGap","emphasis","focus","option","tooltip","trigger","axisPointer","legend","dataZoom","show","realtime","start","xAxisIndex","toolbox","orient","left","top","feature","mark","dataView","readOnly","magicType","restore","saveAsImage","xAxis","axisTick","yAxis","setOption","getData","getColumns","title","dataIndex","render","value","record","style","width","height","src","local_name","onSelectChange","handleClose","pSelectedRowKeys","pSelectedRows","splice","indexOf","showModal","this","c","rowSelection","onChange","className","marginBottom","span","String","t","closable","onClose","onClick","size","tip","sticky","pagination","dataSource","columns","centered","onOk","onCancel","bodyStyle","id","PureComponent","Component"],"mappings":"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","file":"static/js/8.e69570bf.chunk.js","sourcesContent":["/* eslint-disable */\nimport each from 'lodash/each';\nimport isArray from 'lodash/isArray';\nimport isPlainObject from 'lodash/isPlainObject';\n\nimport request from 'superagent';\n\nconst noop = () => {};\nconst apiBase = `${window.location.origin}/api`;\n\nconst callApi = ({\n  custom = false,\n  api = '',\n  type = 'POST',\n  data = {},\n  success = noop,\n  error = noop\n}) => {\n  return new Promise((resolve, reject) => {\n    request(type, custom?`${api}`:apiBase + api)\n      .timeout(200000)\n      .type('form')\n      .withCredentials()\n      .send(toFlattenMap(data))\n      .end((err, res) => {\n        if (err || !res.ok) {\n          // not alert, console log\n          console.log(`not 200 error msg:${err}`);\n          error(err);\n          reject(err);\n        } else {\n          // http res code is 200\n          // if (res.body.errorCode === 200) {\n          //   // normal\n          //   const stringifiedBigNumber = res.text.replace(\n          //     /([^\\\\])\":(\\d{15,})/g,\n          //     '$1\":\"$2\"'\n          //   );\n          //   const body = JSON.parse(stringifiedBigNumber);\n          //   success(body.response);\n          //   resolve(body.response);\n          // } else if (error) {\n          //   error(res.body);\n          //   reject(res.body);\n          // } else {\n          //   console.warn(res.body.errorDescription);\n          // }\n          const stringifiedBigNumber = res.text.replace(\n              /([^\\\\])\":(\\d{15,})/g,\n              '$1\":\"$2\"'\n            );\n          const body = JSON.parse(stringifiedBigNumber);\n          success(body.response);\n        }\n      });\n  });\n};\n\nexport default callApi;\n\nfunction prepend(prefix, name, separator) {\n  if (prefix) {\n    if (separator) {\n      return `${prefix}.${name}`;\n    }\n    return prefix + name;\n  }\n  return name;\n}\n\nfunction flatten(prefix, obj, map) {\n  if (obj) {\n    if (isArray(obj)) {\n      for (let i = 0; i < obj.length; i++) {\n        const item = obj[i];\n        flatten(prepend(prefix, `[${i}]`, false), item, map);\n      }\n    } else if (isPlainObject(obj)) {\n      if (obj.__type__ === 'map') {\n        each(obj, function (propertyObject, propertyName) {\n          if (propertyName !== '__type__') {\n            flatten(\n              prepend(prefix, `[${propertyName}]`, false),\n              propertyObject,\n              map\n            );\n          }\n        });\n      } else {\n        each(obj, function (propertyObject, propertyName) {\n          flatten(prepend(prefix, propertyName, true), propertyObject, map);\n        });\n      }\n    } else {\n      map[prefix] = obj;\n    }\n  }\n}\n\nfunction toFlattenMap(obj) {\n  const map = {};\n\n  flatten(null, obj, map);\n  return map;\n}\n","//框架依赖\nimport React, {Component, PureComponent} from 'react';\nimport { Select, Input, DatePicker, Row, Col, Button, Tag, Table, Upload, Spin, Modal, message } from 'antd';\nimport callApi from 'utils/callApi';\nimport dayjs from 'dayjs';\nimport moment from 'moment';\nimport * as echarts from 'echarts';\n\nimport './index.less';\n\nconst { TextArea } = Input;\n\nconst { Dragger } = Upload;\nconst {Option} = Select;\nconst { RangePicker } = DatePicker;\nclass Logon extends (PureComponent || Component) {\n  state = {\n  \tmodalSpinning: false,\n  \tspinning: false,\n  \tvisible: false,\n  \tselectedRowKeys: [],\n  \tselectedRows: [],\n  \tcid: '',\n  \tmid: '',\n  \ttableData: [],\n  \tmodalSelect: 'total_volume',\n  \tpickerDate: [moment('2021-07-01', 'YYYY-MM-DD'), moment('2021/07/28', 'YYYY-MM-DD')]\n  }\n\n  componentDidMount () {\n  \tthis.getData();\n  \tthis.test();\n  }\n\n  test = () => {\n  \tconst {cid, mid, pickerDate = []} = this.state;\n\n  \tcallApi({\n  \t\ttype: 'POST',\n  \t\tapi: '/create-entry',\n  \t\tdata: {\n  \t\t\tstartDate: dayjs(pickerDate[0]).format('YYYY-MM-DD'),\n  \t\t\tendDate: dayjs(pickerDate[1]).format('YYYY-MM-DD'),\n  \t\t\tcid,\n  \t\t\tmid\n  \t\t},\n  \t\tsuccess: (res = {}) => {\n\n  \t\t},\n  \t\terror: () => {\n\n  \t\t}\n  \t});\n  }\n  getModalData = () => {\n  \tconst {cid, mid, pickerDate = []} = this.state;\n\n  \tthis.setState({\n  \t\tmodalSpinning: true\n  \t});\n  \tcallApi({\n  \t\ttype: 'POST',\n  \t\tapi: '/statistic/getSkuWeekStatistic',\n  \t\tdata: {\n  \t\t\tstartDate: dayjs(pickerDate[0]).format('YYYY-MM-DD'),\n  \t\t\tendDate: dayjs(pickerDate[1]).format('YYYY-MM-DD'),\n  \t\t},\n  \t\tsuccess: (res = {}) => {\n  \t\t\tconst {daysArray = [], skuWeekData = []} = res;\n  \t\t\tconst legendData = daysArray.map((item) => {\n  \t\t\t\treturn item.start_date_str;\n  \t\t\t});\n\n  \t\t\tconst pSkuWeekData = [...skuWeekData];\n\n  \t\t\tpSkuWeekData.map((arr) => {\n  \t\t\t\tconst newData = arr.map((item, index) => {\n  \t\t\t\t\tconst orders = Number(item.spOrderNum || 0) + Number(item.sbSkuOrderNum || 0) + Number(item.sbvOrderNum || 0) + Number(item.sdOrderNum || 0);\n  \t\t\t\t\tconst adCost = (Number(item.spCost || 0) + Number(item.sbSkuCost || 0) + Number(item.sbvCost || 0) + Number(item.sdCost || 0)).toFixed(2);\n  \t\t\t\t\titem.key = item.local_sku + '_' + item.mid;\n  \t\t\t\t\titem.allOrders = Number(orders);\n  \t\t\t\t\titem.adCost = Number(adCost);\n  \t\t\t\t\titem.adCpo = orders ? (adCost / orders).toFixed(2) : 0;\n  \t\t\t\t\treturn item;\n  \t\t\t\t});\n  \t\t\t\treturn newData;\n  \t\t\t});\n  \t\t\tthis.setState({\n  \t\t\t\tmodalSpinning: false,\n  \t\t\t\tdaysArray,\n  \t\t\t\tlegendData,\n  \t\t\t\tskuWeekData: pSkuWeekData\n  \t\t\t}, () => {\n  \t\t\tthis.initChartPie();\n  \t\t\t});\n  \t\t},\n  \t\terror: () => {\n\n  \t\t}\n  \t});\n  }\n  initChartPie = () => {\n  \tconst {categories = [], modalSelect, selectedRowKeys = [], tableData = [], legendData = [], skuWeekData = [], x_axis = []} = this.state;\n\n  \tvar chartDom = document.getElementById('chart_pie');\n  \tvar myChart = echarts.init(chartDom, 'dark');\n\n  \tlet totalVolumeArray = [];\n  \tlet nameArray = [];\n  \tlet legendTitle = [];\n  \tlegendData.map((dayStr, index) => {\n  \t\t// skuWeekData[index];\n  \t\tconst childArray = [];\n  \t\tconst nameChiladArray = [];\n  \t\tselectedRowKeys.map((keyValue) => {\n  \t\t\tconst obj = skuWeekData[index].filter((element) => {\n  \t\t\t\treturn element.local_sku_mid === keyValue;\n  \t\t\t})[0] || {};\n  \t\t\tchildArray.push(Number(obj[modalSelect] || 0));\n\n  \t\t\tconst tableObj = tableData.filter((element) => {\n  \t\t\t\treturn element.local_sku_mid === keyValue;\n  \t\t  })[0] || {};\n\n  \t\t  nameChiladArray.push(tableObj.local_sku + '_' + tableObj.country);\n  \t\t});\n  \t\ttotalVolumeArray.push(childArray);\n  \t\tnameArray.push(nameChiladArray);\n  \t});\n\n  \tconst labelOption = {\n  \t\tshow: true,\n  \t\t// rotate: 90,\n\n  \t\tdistance: 15,\n  \t\talign: 'left',\n  \t\tverticalAlign: 'middle',\n  \t\tposition: 'insideBottom',\n  \t\tformatter: '{c}',\n  \t\tfontSize: 16,\n\n  \t};\n  \tconst series = [];\n  \ttotalVolumeArray.map((data, index) => {\n  \t\tseries.push({\n  \t\t\tname: legendData[index],\n  \t\t\ttype: 'bar',\n  \t\t\tbarGap: 0,\n  \t\t\t// label: labelOption,\n  \t\t\temphasis: {\n  \t\t\t\tfocus: 'series'\n  \t\t\t},\n  \t\t\tdata: data\n  \t\t});\n  \t});\n  \tconst option = {\n  \t\ttooltip: {\n  \t\t\ttrigger: 'axis',\n  \t\t\taxisPointer: {\n  \t\t\t\ttype: 'shadow'\n  \t\t\t}\n  \t\t},\n  \t\tlegend: {\n  \t\t\t// data: ['Forest', 'Steppe', 'Desert', 'Wetland']\n  \t\t\tdata: legendData\n  \t\t},\n  \t\tdataZoom: [\n  \t\t\t{\n  \t\t\t\tshow: true,\n  \t\t\t\trealtime: true,\n  \t\t\t\tstart: 0,\n  \t\t\t\tend: 100,\n  \t\t\t\txAxisIndex: [0, 1]\n  \t\t\t}\n  \t\t],\n  \t\ttoolbox: {\n  \t\t\tshow: true,\n  \t\t\torient: 'vertical',\n  \t\t\tleft: 'right',\n  \t\t\ttop: 'center',\n  \t\t\tfeature: {\n  \t\t\t\tmark: {show: true},\n  \t\t\t\tdataView: {show: true, readOnly: false},\n  \t\t\t\tmagicType: {show: true, type: ['line', 'bar', 'stack', 'tiled']},\n  \t\t\t\trestore: {show: true},\n  \t\t\t\tsaveAsImage: {show: true}\n  \t\t\t}\n  \t\t},\n  \t\txAxis: [\n  \t\t\t{\n  \t\t\t\ttype: 'category',\n  \t\t\t\taxisTick: {show: false},\n  \t\t\t\tdata: nameArray[0],\n\n  \t\t\t}\n  \t\t],\n  \t\tyAxis: [\n  \t\t\t{\n  \t\t\t\ttype: 'value'\n  \t\t\t}\n  \t\t],\n  \t\tseries: series\n  \t};\n\n  \toption && myChart.setOption(option);\n  }\n  getData = () => {\n  \tconst {cid, mid, pickerDate = []} = this.state;\n\n  \tthis.setState({\n  \t\tspinning: true\n  \t});\n  \tcallApi({\n  \t\ttype: 'POST',\n  \t\tapi: '/statistic/getProfit',\n  \t\tdata: {\n  \t\t\tstartDate: dayjs(pickerDate[0]).format('YYYY-MM-DD'),\n  \t\t\tendDate: dayjs(pickerDate[1]).format('YYYY-MM-DD'),\n  \t\t\tcid,\n  \t\t\tmid\n  \t\t},\n  \t\tsuccess: (res = {}) => {\n  \t\t\tres.map((item, index) => {\n  \t\t\t\tconst orders = Number(item.spOrderNum || 0) + Number(item.sbSkuOrderNum || 0) + Number(item.sbvOrderNum || 0) + Number(item.sdOrderNum || 0);\n  \t\t\t\tconst adCost = (Number(item.spCost || 0) + Number(item.sbSkuCost || 0) + Number(item.sbvCost || 0) + Number(item.sdCost || 0)).toFixed(2);\n  \t\t\t\titem.key = item.local_sku + '_' + item.mid;\n  \t\t\t\titem.allOrders = orders;\n  \t\t\t\titem.adCost = adCost;\n  \t\t\t\titem.adCpo = orders ? (adCost / orders).toFixed(2) : 0;\n  \t\t\t\treturn item;\n  \t\t\t});\n  \t\t\tthis.setState({\n  \t\t\t\tspinning: false,\n  \t\t\t\ttableData: res || []\n  \t\t\t}, () => {\n  \t      // this.getModalData();\n  \t\t\t\tconsole.log(res);\n  \t\t\t});\n  \t\t},\n  \t\terror: () => {\n\n  \t\t}\n  \t});\n  }\n\n  getColumns = () => {\n  \treturn [\n  \t\t{\n  \t\t\ttitle: '图片',\n  \t\t\tdataIndex: 'small_image_url',\n  \t\t\tkey: 'small_image_url',\n  \t\t\trender: (value, record,) => {\n  \t\t\t\treturn <img style={{width: 36, height: 36}} src={value}/>;\n  \t\t\t}\n  \t\t},\n  \t\t{\n  \t\t\ttitle: '品名',\n  \t\t\tdataIndex: 'local_name',\n  \t\t\tkey: 'local_name',\n  \t\t\trender: (value, record,) => {\n  \t\t\t\treturn <div>\n  \t\t\t\t\t<div>{record.local_name}</div>\n  \t\t\t\t\t{/* <div>{record.local_sku}</div> */}\n  \t\t\t\t</div>;\n  \t\t\t}\n  \t\t},\t{\n  \t\t\ttitle: '国家',\n  \t\t\tdataIndex: 'country',\n  \t\t\tkey: 'country',\n  \t\t},\n  \t\t{\n  \t\t\ttitle: '销量',\n  \t\t\tdataIndex: 'total_volume',\n  \t\t\tkey: 'total_volume',\n  \t\t}, {\n  \t\t\ttitle: '销售额',\n  \t\t\tdataIndex: 'total_amount',\n  \t\t\tkey: 'total_amount',\n  \t\t\trender: (value, record,) => {\n  \t\t\t\treturn <span>{value && Number(value).toFixed(2)}</span>;\n  \t\t\t}\n  \t\t}, {\n  \t\t\ttitle: '广告花费',\n  \t\t\tdataIndex: 'address',\n  \t\t\tkey: 'address',\n  \t\t\trender: (value, record,) => {\n  \t\t\t\treturn <div>\n  \t\t\t\t\t{(Number(record.spCost || 0) + Number(record.sbSkuCost || 0) + Number(record.sbvCost || 0) + Number(record.sdCost || 0)).toFixed(2)}\n  \t\t\t\t</div>;\n  \t\t\t}\n  \t\t},\n  \t\t{\n  \t\t\ttitle: '广告订单量',\n  \t\t\tdataIndex: 'address',\n  \t\t\tkey: 'address',\n  \t\t\trender: (value, record,) => {\n  \t\t\t\treturn <div>\n  \t\t\t\t\t{Number(record.spOrderNum || 0) + Number(record.sbSkuOrderNum || 0) + Number(record.sbvOrderNum || 0) + Number(record.sdOrderNum || 0)}\n  \t\t\t\t</div>;\n  \t\t\t}\n  \t\t}, {\n  \t\t\ttitle: '每单花费',\n  \t\t\tdataIndex: 'sessions',\n  \t\t\tkey: 'sessions',\n  \t\t\trender: (value, record,) => {\n  \t\t\t\tconst orders = Number(record.spOrderNum || 0) + Number(record.sbSkuOrderNum || 0) + Number(record.sbvOrderNum || 0) + Number(record.sdOrderNum || 0);\n  \t\t\t\tconst adCost = (Number(record.spCost || 0) + Number(record.sbSkuCost || 0) + Number(record.sbvCost || 0) + Number(record.sdCost || 0)).toFixed(2);\n  \t\t\t\treturn <div>\n  \t\t\t\t\t{orders ? (adCost / orders).toFixed(2) : 0}\n  \t\t\t\t</div>;\n  \t\t\t}\n  \t\t}\n  \t];\n  }\n  onSelectChange = (selectedRowKeys, selectedRows) => {\n  \tthis.setState({\n  \t\tselectedRowKeys,\n  \t\tselectedRows\n  \t});\n  };\n\n  handleClose = (key) => {\n  \tconst {selectedRowKeys, selectedRows} = this.state;\n  \tconst pSelectedRowKeys = [...selectedRowKeys];\n  \tconst pSelectedRows = [...selectedRows];\n  \tpSelectedRowKeys.splice(selectedRowKeys.indexOf(key), 1);\n  \tpSelectedRows.splice(selectedRowKeys.indexOf(key), 1);\n  \tthis.setState({\n  \t\tselectedRowKeys: pSelectedRowKeys,\n  \t\tselectedRows: pSelectedRows\n  \t});\n  }\n\n  showModal = () => {\n  \t// this.getModalData();\n  \tthis.setState({\n  \t\tvisible: true\n  \t}, () => {\n  \t\tthis.getModalData();\n  \t});\n  }\n  render () {\n  \tconst {spinning, modalSelect, modalSpinning, visible, mid, selectedRows = [], selectedRowKeys = [], cid, tableData = [], pickerDate = []} = this.state;\n\n  \tconst rowSelection = {\n  \t\tselectedRowKeys,\n  \t\tonChange: this.onSelectChange\n\n  \t};\n\n  \treturn <div className=\"week-report\">\n  \t\t<div style={{marginBottom: '16px'}}>\n  \t\t\t<Row >\n  \t\t\t\t<Col span={6}>\n          请选择分类：\n  \t\t\t<Select value={String(cid)} style={{ width: 120 }} onChange={(value) => {\n  \t\t\t\tthis.setState({\n  \t\t\t\t\tcid: value\n  \t\t\t\t}, () => {\n  \t\t\t\t\tthis.getData();\n  \t\t\t\t});\n  \t\t\t}}>\n  \t\t\t\t\t<Option value=\"\">全部</Option>\n  \t\t\t\t<Option value=\"1001\">美妆</Option>\n  \t\t\t\t<Option value=\"1002\">电子器件</Option>\n  \t\t\t</Select>\n  \t\t\t\t</Col>\n\n  \t\t\t\t<Col span={6}>\n          请选择国家：\n  \t\t\t<Select value={String(mid)} style={{ width: 120 }} onChange={(value) => {\n  \t\t\t\tthis.setState({\n  \t\t\t\t\tmid: value\n  \t\t\t\t}, () => {\n  \t\t\t\t\tthis.getData();\n  \t\t\t\t});\n  \t\t\t}}>\n  \t\t\t\t<Option value=\"\">全部</Option>\n  \t\t\t\t<Option value=\"1\">美国</Option>\n  \t\t\t\t<Option value=\"4\">英国</Option>\n  \t\t\t\t<Option value=\"5\">德国</Option>\n  \t\t\t\t<Option value=\"6\">法国</Option>\n  \t\t\t\t<Option value=\"7\">意大利</Option>\n  \t\t\t\t<Option value=\"8\">西班牙</Option>\n  \t\t\t\t<Option value=\"10\">日本</Option>\n  \t\t\t\t<Option value=\"15\">荷兰</Option>\n  \t\t\t</Select>\n  \t\t\t</Col>\n\n  \t\t\t<Col span={6}>\n        请选择时间：\n  \t\t\t<RangePicker\n  \t\t\t\tvalue={pickerDate}\n  \t\t\t\tonChange={(value) => {\n  \t\t\t\tthis.setState({\n  \t\t\t\t\tpickerDate: value\n  \t\t\t\t}, () => {\n  \t\t\t\t\t\tthis.getData();\n  \t\t\t\t\t});\n  \t\t\t}}/>\n  \t\t</Col>\n\n  \t\t\t</Row>\n  \t\t</div>\n  \t\t{selectedRows.length > 0 && \t<div className=\"selected-bar\">\n        已选中: {selectedRows.map((item) => {\n  \t\t\t\treturn <Tag closable key={item.local_sku + '_' + item.mid} onClose={() => this.handleClose(item.local_sku + '_' + item.mid)}\n  \t\t\t\t>\n  \t\t\t\t\t{item.local_sku + '_' + item.country}\n  \t\t\t\t</Tag>;\n  \t\t\t})}\n  \t\t\t<Button type=\"primary\" onClick={() => {\n  \t\t\t\tthis.showModal();\n  \t\t\t}}>查看详情</Button>\n  \t\t</div>}\n\n  \t\t<Spin size=\"large\" tip=\"正在获取数据，请稍等...\" spinning={spinning}>\n  \t\t\t<Table sticky rowSelection={rowSelection} size=\"small\" pagination={false} dataSource={tableData} columns={this.getColumns()} />\n  \t\t</Spin>\n  \t\t<Modal\n  \t\t\ttitle=\"详情对照\"\n  \t\t\tcentered\n  \t\t\tvisible={visible}\n  \t\t\tonOk={() => this.setState({visible: false})}\n  \t\t\tonCancel={() => this.setState({visible: false})}\n  \t\t\twidth={'100vw'}\n  \t\t\t// height={'90vh'}\n  \t\t\tbodyStyle={\n  \t\t\t\t{height: '80vh'}\n  \t\t\t}\n  \t\t>\n  \t\t\t<Spin spinning={modalSpinning} style={{width: '100%', height: '70vh'}}>\n  \t\t\t\t<div style={{marginBottom: '16px'}}>\n  \t\t\t\t\t<Row >\n  \t\t\t\t\t\t<Col span={6}>\n              请选择类别：\n  \t\t\t\t\t\t\t<Select value={String(modalSelect)} style={{ width: 120 }} onChange={(value) => {\n  \t\t\t\t\t\t\t\tthis.setState({\n  \t\t\t\t\t\t\t\t\tmodalSelect: value\n  \t\t\t\t\t\t\t\t}, () => {\n  \t\t\t\t\t\t\t\t\tthis.initChartPie();\n  \t\t\t\t\t\t\t\t});\n  \t\t\t\t\t\t\t}}>\n\n  \t\t\t\t\t\t\t\t<Option value=\"total_volume\">销量</Option>\n  \t\t\t\t\t\t\t\t<Option value=\"total_amount\">销售额</Option>\n  \t\t\t\t\t\t\t\t<Option value=\"adCost\">广告花费</Option>\n  \t\t\t\t\t\t\t\t<Option value=\"allOrders\">广告订单量</Option>\n  \t\t\t\t\t\t\t\t<Option value=\"adCpo\">每单花费</Option>\n\n  \t\t\t\t\t\t\t</Select>\n  \t\t\t\t</Col>\n  \t\t\t\t\t</Row>\n  \t\t\t\t</div>\n  \t\t\t\t<div id=\"chart_pie\" style={{width: '100%', height: '70vh'}}/>\n\n  \t\t\t</Spin>\n  \t\t</Modal>\n  \t</div>;\n  }\n}\nexport default Logon;\n"],"sourceRoot":""}